[
    % TODO this is needed to deploy oneprovider on distributed env on dockers
    % Range of ports that will be used by erlang nodes to communicate
    {kernel, [
        {inet_dist_listen_min, 9100},
        {inet_dist_listen_max, 9139}
    ]},

    %% SASL config
    {sasl, [{sasl_error_logger, false}]},

    %% logger configuration
    {lager, [
        {colored, true},
        {handlers, [
            %% show info level or higher level logs at console
            {lager_console_backend, [info, {lager_default_formatter, [color, "[", sev, " ", time, " ", pid, "] ", message, "\e[0m\r\n"]}]},
            %% rotate error log when it reaches 50 MB; keep 10 rotated logs
            {lager_file_backend, [
                {file, "{{platform_log_dir}}/error.log"},
                {level, error},
                {size, 52428800},
                {count, 10},
                {formatter, lager_default_formatter},
                {formatter_config, ["[", sev, " ", date, " ", time, " ", pid, "] ", message, "\n"]}
            ]},
            %% rotate info log when it reaches 50 MB; keep 10 rotated logs
            {lager_file_backend, [
                {file, "{{platform_log_dir}}/info.log"},
                {level, info},
                {size, 52428800},
                {count, 10},
                {formatter, lager_default_formatter},
                {formatter_config, ["[", sev, " ", date, " ", time, " ", pid, "] ", message, "\n"]}
            ]},
            %% rotate debug log when it reaches 50 MB; keep 10 rotated logs
            {lager_file_backend, [
                {file, "{{platform_log_dir}}/debug.log"},
                {level, debug},
                {size, 52428800},
                {count, 10},
                {formatter, lager_default_formatter},
                {formatter_config, ["[", sev, " ", date, " ", time, " ", pid, "] ", message, "\n"]}
            ]}
        ]},
        % Limit for the number of messages per second allowed from error_logger
        {error_logger_hwm, 200},
        % When lager should change mode to synchronous (log queue is longer than async_threshold)
        {async_threshold, 500},
        % When lager should return from synchronous mode to asynchronous (log queue is shorter than (async_threshold - async_threshold_window)
        {async_threshold_window, 50}
    ]},

    %% mnesia config
    {mnesia, [
        {dump_log_write_threshold, 50000}
    ]},

    %% cluster_worker config
    {cluster_worker, [

        %% ===================================================================
        %% PLUGINS
        %% ===================================================================

        % names of modules implementing given plugins
        {datastore_config_plugin, datastore_config_plugin},
        {node_manager_plugin, node_manager_plugin},
        {identity_repository, oz_identity_repository},
        {identity_cache, db_identity_cache},

        {datastore_cache_size, [
            {memory, 500000},
            {disc, 500000}
        ]},
        %% Maps to an 'order' parameter of a bp_tree library
        {datastore_links_tree_order, 1024},

        {couchbase_durability_interval, 500},
        {couchbase_pool_size, [
            {'_', [
                {read, 10},
                {write, 20},
                {changes, 3}
            ]}
        ]},
        {couchbase_pool_batch_size, 2000},
        {couchbase_pool_max_batch_size, 2000},
        {couchbase_pool_min_batch_size, 250},

        {throttling_delay_db_queue_size, 6000},
        {throttling_db_queue_limit, 15000},
        {throttling_start_memory_proc_number, 100000},
        {throttling_max_memory_proc_number, 200000},

        {throttling_active_check_interval_seconds, 15},
        {throttling_check_interval_seconds, 15},
        {throttling_base_time_ms, 32},

        {monitoring_log_file, "{{platform_log_dir}}/node_manager_monitoring.log"}
    ]},

    %% op_worker config
    {op_worker, [
        %% ===================================================================
        %% GENERAL
        %% ===================================================================

        %% List of possible cluster manager nodes - configured automatically by configurator.erl lib, used in GEN_DEV script
        {cm_nodes, ['cm@127.0.0.1']},
        %% List of all DBMS nodes - configured automatically by configurator.erl lib, used in GEN_DEV script
        {db_nodes, ['127.0.0.1:49161']},


        %% ===================================================================
        %% Server certificates
        %% ===================================================================

        %% If enabled and there is no web key/cert under expected paths
        %% (web_key_file, web_cert_file) during startup, a new web cert will be
        %% generated with CN matching provider domain and signed by CA cert
        %% found under test_web_cert_ca_path.
        %% This functionality is devised for test purposes and should not be
        %% used in production.
        {generate_web_cert_if_absent, true},
        {test_web_cert_domain, "onedata.org"},

        %% The CA cert to sign auto generated test web certs. The file must
        %% contain both the key and cert.
        {test_web_cert_ca_path, "{{platform_etc_dir}}/cacerts/OneDataTestWebServerCa.pem"},
        %% Path to private key used by web server
        {web_key_file, "{{platform_etc_dir}}/certs/web_key.pem"},
        %% Path to certificate used by web server
        {web_cert_file, "{{platform_etc_dir}}/certs/web_cert.pem"},
        %% By default, the same certs are used for web and proto servers.
        %% Below options are here in case there is a need to differentiate them.
        %% Path to private key used by client listener
        {protocol_handler_key_file, "{{platform_etc_dir}}/certs/web_key.pem"},
        %% Path to certificate used by client listener
        {protocol_handler_cert_file, "{{platform_etc_dir}}/certs/web_cert.pem"},
        %% Path to dir containing CA certificates
        {cacerts_dir, "{{platform_etc_dir}}/cacerts"},
        %% Path to OZ CA cert file (inside cacerts_dir)
        {oz_ca_file, "ozp_cacert.pem"},
        %% List of ports used by application and required to be free during installation process.
        {application_ports, [53, 80, 443, 5555, 8443]},
        %% Prefix to directory containing NIF libs
        {nif_prefix, "priv"},
        {dbsync_flush_queue_interval, 3000},
        %% Size of permission cache (when documents count in cache is greater
        %% than this param, cache is invalidated)
        {permission_cache_size, 20000},
        % time between periodic permission cache removals
        {invalidate_permission_cache_interval_seconds, 30},


        %% ===================================================================
        %% DISPATCHER
        %% ===================================================================

        %% Number of threads used by dispatcher
        {protocol_handler_pool_size, 100},
        %% Number of port used by dispatcher
        {protocol_handler_port, 5555},
        %% Number of port used by provider-to-provider endpoint
        {provider_protocol_handler_port, 5556},

        %% ===================================================================
        %% GUI
        %% ===================================================================

        %% Port on which gui is available
        {gui_https_port, 443},
        %% Number of accepting processes in gui listener
        {gui_number_of_acceptors, 100},
        %% Number of accepting processes on port 80 (redirecting to https)
        {gui_number_of_http_acceptors, 20},
        %% Maximum number of HTTP requests without closing the connection (HTTP/1.1 only)
        {gui_max_keepalive, 30},
        %% Socket timeout in sec
        {gui_socket_timeout_seconds, 60},
        %% GUI cookie TTL in sec
        {gui_session_ttl_seconds, 3600},
        %% Buffer size used to send files to a web client, in bytes.
        {gui_download_buffer, 4194304}, % 4MB
        %% Directory where op-worker tries to find static files of a custom GUI.
        %% If the directory is not empty, it will serve the static files
        %% from it. If not, it will fall back to default, embedded GUI.
        {gui_custom_static_root, "/var/www/html/op_worker"},
        %% Directory where static files of default, embedded GUI are kept.
        %% Used when gui_custom_static_root is non-existent or empty.
        {gui_default_static_root, "{{platform_data_dir}}/gui_static"},
        %% List of HTTP headers that will be send with every response.
        {gui_response_headers, [
            {<<"X-Frame-Options">>, <<"SAMEORIGIN">>}
%%            {<<"Strict-Transport-Security">>, <<"max-age=31536000; includeSubDomains">>}
        ]},
        %% How many files will be displayed in gui data browser at once.
        %% If there are more files in the directory, they will be downloaded
        %% on demand when the user scrolls down near the bottom of the list.
        {gui_file_children_chunk_size, 50},


        %% ===================================================================
        %% FILE UPLOAD
        %% ===================================================================

        %% How many bytes will be read from socket at once during upload.
        {upload_read_size, 100000},
        %% Timeout for reading upload_read_size bytes from socket.
        {upload_read_timeout, 300000},
        %% How many bytes will be written to filesystem at once during upload.
        %% Such chunk will be accumulated using
        %% multiple reads of upload_read_size.
        {upload_write_size, 1000000},


        %% ===================================================================
        %% REST
        %% ===================================================================

        %% Port on which REST API is available
        {rest_port, 8443},
        %% Number of accepting processes in REST listener
        {rest_number_of_acceptors, 100},
        %% Socket timeout in sec
        {rest_socket_timeout_seconds, 60},

        %% List of protocols which will be available on http_worker_rest_port.
        {protocol_plugins, [rest_protocol_plugin, cdmi_protocol_plugin]},

        %% ===================================================================
        %% CDMI
        %% ===================================================================

        %% Size of download buffer. Currently set to 8MB.
        {download_buffer_size, 8388608},
        %% Maximum amount of directory children that can be requested in one request
        {max_children_per_request, 1000},

        %% ===================================================================
        %% SEQUENCER_MANAGER
        %% ===================================================================

        %% Maximal amount of messages that can be forwarded by sequencer
        %% stream between successive emissions of acknowledgement messages.
        {sequencer_stream_msg_ack_threshold, 100},
        %% Amount of seconds that have to elapse before sending next request
        %% when waiting for missing messages.
        {sequencer_stream_msg_req_short_timeout_seconds, 1},
        %% Amount of seconds that have to elapse before sending next request
        %% when not waiting for missing messages.
        {sequencer_stream_msg_req_long_timeout_seconds, 10},
        %% Amount of seconds that have to elapse before next attempt to send
        %% message by sequencer out stream.
        {sequencer_stream_msg_send_retry_delay_seconds, 5},

        %% ===================================================================
        %% SESSION_WATCHER
        %% ===================================================================

        %% Maximal period of FUSE session inactivity before removal
        {fuse_session_ttl_seconds, 300},
        %% Maximal period of REST session inactivity before removal
        {rest_session_ttl_seconds, 3600},
        %% Maximal period of Provider's session inactivity before removal
        {provider_session_ttl_seconds, 3600},
        %% NOTE! GUI session TTL is managed by 'gui_session_ttl_seconds' env
        %% defined in GUI section.

        %% ===================================================================
        %% OZ INTERFACING
        %% ===================================================================

        %% OZ hostname
        {oz_domain, "onedata.org"},
        %% OZ login page (relative to domain)
        {oz_login_page, "/#/home/login"},
        %% OZ logout page (relative to domain)
        {oz_logout_page, "/#/home/logout"},
        %% OZ manage providers page (relative to domain)
        {oz_providers_page, "/#/onezone"},
        %% Path to .pem file containing the original CSR to be signed by OZ
        {oz_provider_csr_file, "{{platform_etc_dir}}/certs/ozp_csr.pem"},
        %% Path to .pem file containing the private key to the grpcert
        {oz_provider_key_file, "{{platform_etc_dir}}/certs/ozp_key.pem"},
        %% Path to .pem file containing the certificate signed by OZ CA, used for authorizing requests to it
        {oz_provider_cert_file, "{{platform_etc_dir}}/certs/ozp_cert.pem"},
        %% OZ REST API port
        {oz_rest_port, 8443},
        %% OZ REST API prefix
        {oz_rest_api_prefix, "/api/v3/onezone"},

        %% ===================================================================
        %% IDENTITY
        %% ===================================================================

        {identity_key_file, "{{platform_data_dir}}/identity_key.pem"},
        {identity_cert_file, "{{platform_data_dir}}/identity_cert.pem"},

        %% ===================================================================
        %% FSLOGIC
        %% ===================================================================

        %% Events configuration
        {file_read_event_time_threshold_milliseconds, 1000},
        {file_written_event_time_threshold_milliseconds, 1000},

        %% Default values
        {default_dir_mode, 8#775},
        {default_file_mode, 8#664},

        %% Default number of listed children in lfm:get_children_count
        {ls_chunk_size, 5000},

        %% Default size of file content chunk copied at once in rename_req
        {rename_file_chunk_size, 8388608}, %% 8MB

        %% Number of bytes that can be accepted by provider over quota limit before all write requests become ignored
        {soft_quota_limit_size, 1073741824}, %% 1GB

        %% ===================================================================
        %% RTRANSFER
        %% ===================================================================
        %% Tells if rtransfer should be started on fslogic_worker init
        {start_rtransfer_on_init, true},
        %% Number of parallel rtransfer streams between providers
        {streams_number, 10},

        %% ===================================================================
        %% HELPERS
        %% ===================================================================

        %% Default timeout for the storage helper asynchronous operation
        {helpers_async_operation_timeout_milliseconds, 30000},
        %% Max latency for the proxy helper operations
        {proxy_helper_latency_milliseconds, 5000},
        %% Number of parallel POSIX helper threads.
        {posix_helper_threads_number, 8},
        %% Number of parallel Ceph helper threads.
        {ceph_helper_threads_number, 8},
        %% Number of parallel S3 helper threads.
        {s3_helper_threads_number, 8},
        %% Number of parallel Swift helper threads.
        {swift_helper_threads_number, 8},
        %% Number of parallel GlusterFS helper threads.
        {glusterfs_helper_threads_number, 8},
        %% Defines whether buffer storage helpers read/write operations.
        {buffer_helpers, false},
        %% Number of parallel buffer scheduler threads.
        {buffer_scheduler_threads_number, 1},
        %% Minimum size in bytes of in-memory cache for input data blocks.
        {read_buffer_min_size, 5242880}, % 5MB
        %% Maximum size in bytes of in-memory cache for input data blocks.
        {read_buffer_max_size, 10485760}, % 10MB
        %% Read ahead period in seconds of in-memory cache for input data blocks.
        {read_buffer_prefetch_duration, 1}, % 1s
        %% Minimum size in bytes of in-memory cache for output data blocks.
        {write_buffer_min_size, 20971520}, % 20MB
        %% Maximum size in bytes of in-memory cache for output data blocks.
        {write_buffer_max_size, 52428800}, % 50MB
        %% Idle period in seconds before flush of in-memory cache for output data blocks.
        {write_buffer_flush_delay, 5}, % 5s


        %% ===================================================================
        %% LUMA
        %% ===================================================================

        %% User/Group storage ID mapping boundaries
        {luma_posix_uid_range, {100000, 2000000}},
        {luma_posix_gid_range, {100000, 2000000}},

        %% ===================================================================
        %% PREFETCHING
        %% ===================================================================

        %% Sync requests which are smaller will be extended to 4MB
        {minimal_sync_request, 4194304},
        %% Synchronization of byte 0, 50MB, 100MB etc. will trigger prefetching
        {trigger_byte, 52428800},
        %% Amount of data to prefetch at once
        {prefetch_size, 104857600},

        %% ===================================================================
        %% MONITORING
        %% ===================================================================

        %% Size of worker pool for rrdtool
        {rrdtool_pool_size, 10},
        %% Maximum size of worker pool overflow for rrdtool
        {rrdtool_pool_max_overflow, 10},

        %% ===================================================================
        %% SPACE SYNC WORKER
        %% ===================================================================
        %% Interval between successive check strategies, in seconds
        {check_strategies_interval, 10},
        % Number of workers that will handle storage_sync dir jobs
        {storage_sync_dir_workers_num, 10},
        % Number of workers that will handle storage_sync file jobs
        {storage_sync_file_workers_num, 10},
        % Number of workers that will handle jobs other than import and update
        {generic_strategy_workers_num, 40},
        % Size of batch of files listed during syncing storage
        {dir_batch_size, 100},
        % Number of time slots from which monitoring data is saved
        {storage_sync_histogram_length, 12},

        %% ===================================================================
        %% REPLICATION
        %% ===================================================================
        %% Number of workers that will be responsible for replicating files
        {replication_pool_size, 10},

        %% ===================================================================
        %% GRAPH SYNC
        %% ===================================================================
        %% Port number in OneZone where Graph Sync server is hosted
        {graph_sync_port, 8443},
        %% HTTP path where Graph Sync websocket client should connect
        {graph_sync_path, "/graph_sync"},
        %% Maximum time to wait for response from OZ before returning timeout error.
        {graph_sync_request_timeout, 6000}, % 6 seconds
        %% How often Graph Sync channel is health-checked
        {graph_sync_healthcheck_interval, 4000}, % 5 seconds
        %% Rate of reconnect attempt delay increase for Graph Sync channel.
        {graph_sync_reconnect_backoff_rate, 1.5},
        %% Maximum delay between reconnect attempts for Graph Sync channel.
        {graph_sync_reconnect_max_backoff, 300000} % 5 minutes
    ]}
].
